<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/webp" href="https://files.catbox.moe/6wjxg6.webp">
  <?!= HtmlService.createHtmlOutputFromFile('styles').getContent(); ?>
</head>
<body>
  <!-- スプラッシュ画面 -->
  <div id="splash" style="
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:linear-gradient(135deg,#0a0a1a 0%,#0d1f2d 30%,#1a3a4a 60%,#0d1f2d 100%);
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    z-index:9999;opacity:1;transition:opacity 0.6s ease-out;
  ">
    <style>
      @keyframes logoFloat {
        0%{opacity:0;transform:scale(0.3) translateY(40px);filter:blur(20px)}
        50%{opacity:1;transform:scale(1.05) translateY(-5px);filter:blur(0)}
        70%{transform:scale(0.98) translateY(2px)}
        100%{opacity:1;transform:scale(1) translateY(0);filter:blur(0)}
      }
      @keyframes titleReveal {
        0%{opacity:0;letter-spacing:20px;filter:blur(10px)}
        60%{opacity:1;letter-spacing:4px;filter:blur(0)}
        100%{opacity:1;letter-spacing:2px}
      }
      @keyframes subtitleFade {
        0%{opacity:0;transform:translateY(15px)}
        100%{opacity:1;transform:translateY(0)}
      }
      @keyframes lineExpand {
        0%{width:0;opacity:0}
        100%{width:120px;opacity:1}
      }
      @keyframes dotPulse {
        0%,100%{opacity:0.3;transform:scale(0.8)}
        50%{opacity:1;transform:scale(1.2)}
      }
      @keyframes glowPulse {
        0%,100%{box-shadow:0 0 20px rgba(0,186,124,0.3),0 0 60px rgba(0,210,140,0.1)}
        50%{box-shadow:0 0 40px rgba(0,186,124,0.6),0 0 80px rgba(0,210,140,0.3)}
      }
      @keyframes iconFloat1 {
        0%{opacity:0;transform:translate(-60px,40px) scale(0) rotate(-20deg)}
        40%{opacity:0.7;transform:translate(-55px,-10px) scale(1.1) rotate(5deg)}
        100%{opacity:0.5;transform:translate(-58px,0) scale(1) rotate(0)}
      }
      @keyframes iconFloat2 {
        0%{opacity:0;transform:translate(60px,30px) scale(0) rotate(15deg)}
        40%{opacity:0.7;transform:translate(55px,-15px) scale(1.1) rotate(-5deg)}
        100%{opacity:0.5;transform:translate(58px,-5px) scale(1) rotate(0)}
      }
      @keyframes iconFloat3 {
        0%{opacity:0;transform:translate(-40px,-50px) scale(0) rotate(10deg)}
        40%{opacity:0.6;transform:translate(-35px,-40px) scale(1.05) rotate(-3deg)}
        100%{opacity:0.4;transform:translate(-38px,-45px) scale(1) rotate(0)}
      }
      @keyframes iconFloat4 {
        0%{opacity:0;transform:translate(45px,-45px) scale(0) rotate(-10deg)}
        40%{opacity:0.6;transform:translate(40px,-38px) scale(1.05) rotate(3deg)}
        100%{opacity:0.4;transform:translate(42px,-42px) scale(1) rotate(0)}
      }
      @keyframes iconDrift {
        0%,100%{transform:translateY(0)}
        50%{transform:translateY(-6px)}
      }
      .splash-logo-container{position:relative;width:180px;height:180px;display:flex;align-items:center;justify-content:center}
      .splash-logo{width:90px;height:90px;border-radius:22px;animation:logoFloat 1.2s cubic-bezier(0.34,1.56,0.64,1) forwards,glowPulse 2s ease-in-out 1.2s infinite;opacity:0;position:relative;z-index:2}
      .splash-floating-icon{position:absolute;font-size:22px;z-index:1}
      .splash-floating-icon:nth-child(2){animation:iconFloat1 1s ease-out .3s forwards,iconDrift 3s ease-in-out 1.3s infinite;opacity:0}
      .splash-floating-icon:nth-child(3){animation:iconFloat2 1s ease-out .5s forwards,iconDrift 3s ease-in-out 1.5s infinite alternate;opacity:0}
      .splash-floating-icon:nth-child(4){animation:iconFloat3 1s ease-out .7s forwards,iconDrift 2.5s ease-in-out 1.7s infinite;opacity:0}
      .splash-floating-icon:nth-child(5){animation:iconFloat4 1s ease-out .9s forwards,iconDrift 2.8s ease-in-out 1.9s infinite alternate;opacity:0}
      .splash-title{color:#fff;font-size:22px;font-weight:700;margin-top:24px;font-family:'Inter','Helvetica Neue',sans-serif;animation:titleReveal 1s ease-out .6s forwards;opacity:0}
      .splash-line{height:2px;margin-top:16px;border:none;background:linear-gradient(90deg,transparent,#00ba7c,#1da1f2,transparent);animation:lineExpand .8s ease-out 1.2s forwards;width:0;opacity:0}
      .splash-subtitle{color:rgba(255,255,255,0.6);font-size:13px;margin-top:14px;animation:subtitleFade .6s ease-out 1.6s forwards;opacity:0}
      .splash-dots{display:flex;gap:8px;margin-top:32px}
      .splash-dot{width:6px;height:6px;border-radius:50%;background:#00ba7c;animation:dotPulse 1.2s ease-in-out infinite}
      .splash-dot:nth-child(2){animation-delay:.2s}
      .splash-dot:nth-child(3){animation-delay:.4s}
    </style>
    <div class="splash-logo-container">
      <img src="https://files.catbox.moe/6wjxg6.webp" class="splash-logo">
      <span class="splash-floating-icon">&#x1F4F7;</span>
      <span class="splash-floating-icon">&#x1F517;</span>
      <span class="splash-floating-icon">&#x1F4CA;</span>
      <span class="splash-floating-icon">&#x23F0;</span>
    </div>
    <div class="splash-title">AutoPostTool</div>
    <hr class="splash-line">
    <div class="splash-subtitle">Auto Post & Schedule for Threads</div>
    <div class="splash-dots">
      <div class="splash-dot"></div>
      <div class="splash-dot"></div>
      <div class="splash-dot"></div>
    </div>
  </div>

  <div id="app" style="display:none;">
    <div class="loading"><div class="loading-spinner"></div><div>読み込み中...</div></div>
  </div>

  <script>
    (function(){
      var ended=false,startedAt=Date.now(),minShowMs=2200,autoFadeMs=2800,maxWaitMs=5000;
      
      function endSplashNow(){
        if(ended)return;ended=true;
        var s=document.getElementById('splash'),a=document.getElementById('app');
        if(!s||s.style.display==='none')return;
        s.style.opacity='0';
        setTimeout(function(){
          s.style.display='none';
          if(a) a.style.display='block';
          // スプラッシュ終了後にアプリを初期化
          if(typeof App !== 'undefined' && typeof App.init === 'function'){
            App.init().catch(function(e){ console.error('App.init error:', e); });
          }
        },600);
      }
      
      function requestEnd(){
        var w=Math.max(0,minShowMs-(Date.now()-startedAt));
        setTimeout(endSplashNow,w);
      }
      
      setTimeout(endSplashNow,autoFadeMs);
      setTimeout(endSplashNow,maxWaitMs);
      window.endSplash=function(){requestEnd()};
    })();
  </script>

  <?!= HtmlService.createHtmlOutputFromFile('app_core').getContent(); ?>
  <?!= HtmlService.createHtmlOutputFromFile('app_ui').getContent(); ?>
  <?!= HtmlService.createHtmlOutputFromFile('screen_compose').getContent(); ?>
  <?!= HtmlService.createHtmlOutputFromFile('screen_schedule').getContent(); ?>
  <?!= HtmlService.createHtmlOutputFromFile('screen_history').getContent(); ?>
  <?!= HtmlService.createHtmlOutputFromFile('screen_insights').getContent(); ?>
  <?!= HtmlService.createHtmlOutputFromFile('screen_settings').getContent(); ?>
</body>
</html>
